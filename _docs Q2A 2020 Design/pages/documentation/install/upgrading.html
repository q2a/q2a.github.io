
<!doctype html>

<html class="no-js" lang="en">

<head>
	
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	
	<!-- Disable screen scaling-->
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, user-scalable=0"/>

	<!-- Page Title Here -->
	<title>Upgrading (Documentation) - Question2Answer</title>
	<meta name="description" content=="Upgrading to the latest version of Question2Answer"/>
	<link rel="canonical" href="http://docs.question2answer.org/pages/documentation/install/upgrading/"/>
	
	<!-- Favicons -->
	<link href="../../../images/branding/q2a_96px.png" rel="apple-touch-icon" sizes="96x96" type="image/png">
	<link href="../../../images/branding/q2a_96px.png" rel="icon" sizes="96x96" type="image/png">
	<link href="../../../images/branding/favicon.ico" rel="icon" sizes="16x16" type="image/ico">

	<!-- Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
	<!-- Main CSS files -->
	<link rel="stylesheet" href="../../../css/styles.css"/>
	<link rel="stylesheet" href="../../../css/highlight.css">

	<!-- JS files -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>

<body id="body" class="page">

	<!-- Top Bar -->
	<div id="topBar" class="topBar">
		<div class="topBar-wrapper flex-row">
			<div class="flex-item not-flex-middle">
				<div id="navTrigger" class="material-icons mobile-only">menu</div>
				<a href="https://heliochun.github.io/q2adocs" class="topBarLogo">
					<img src="../../../images/branding/question2answer-logo-350x40.png" class="logo-img normal-logo" />
					<img src="../../../images/branding/question2answer-logo-white-350x40.png" class="logo-img white-logo" />
				</a>
			</div>
			<div id="mobileNav" class="flex-item flex-middle">
				<nav class="main-nav">
					<ul class="nav">
						<li>
							<span class="nav-item selected-nav">Documentation <span class="material-icons">arrow_drop_down</span> </span>
							<ul class="sub-nav display-none">
								<li><a href="https://docs.question2answer.org/pages/documentation/install" class="sub-nav-item selected-nav">Install</a></li>
								<li><a href="https://docs.question2answer.org/pages/documentation/themes" class="sub-nav-item">Themes</a></li>
								<li><a href="https://docs.question2answer.org/pages/documentation/plugins" class="sub-nav-item">Plugins</a></li>
								<li><a href="https://docs.question2answer.org/pages/documentation/code" class="sub-nav-item">Code</a></li>
							</ul>
						</li>
						<li><a href="https://docs.question2answer.org/pages/contribute" class="nav-item">Contribute</a></li>
						<li><a href="https://docs.question2answer.org/pages/translate" class="nav-item">Translate</a></li>
						<li>
							<span class="nav-item">Addons <span class="material-icons">arrow_drop_down</span> </span>
							<ul class="sub-nav display-none">
								<li><a href="https://docs.question2answer.org/pages/addons/themes" class="sub-nav-item">Themes</a></li>
								<li><a href="https://docs.question2answer.org/pages/addons/plugins/" class="sub-nav-item">Plugins</a></li>
								<li><a href="https://docs.question2answer.org/pages/addons/clients/" class="sub-nav-item">Clients</a></li>
								<li><a href="https://docs.question2answer.org/pages/addons/translations/" class="sub-nav-item">Translations</a></li>
							</ul>
						</li>
					</ul>
					<ul class="nav secondary-nav mobile-only">
						<li><a href="https://docs.question2answer.org/pages/services" class="nav-item">Services</a></li>
						<li><a href="https://docs.question2answer.org/pages/sites" class="nav-item">Sites</a></li>
						<li><a href="https://www.question2answer.org/qa" class="nav-item">Q&amp;A</a></li>
					</ul>
				</nav>
			</div>
			<div class="flex-item not-flex-middle not-mobile">
				<ul class="nav secondary-nav">
					<li><a href="https://docs.question2answer.org/pages/services" class="nav-item">Services</a></li>
					<li><a href="https://docs.question2answer.org/pages/sites" class="nav-item">Sites</a></li>
					<li><a href="https://www.question2answer.org/qa" class="nav-item">Q&amp;A</a></li>
				</ul>
			</div>
			<div id="darkPane"></div>
		</div>
	</div>
	
	<!-- Breadcrumbs -->
	<div class="breadcrumbs-container">
		<ul class="breadcrumbs">
			<li class="breadcrumb-item">Documentation</li>
			<li class="breadcrumb-item"><a href="https://docs.question2answer.org/pages/documentation/install">Install</a></li>
			<li class="breadcrumb-item"><a href="https://docs.question2answer.org/pages/documentation/install/upgrading">upgrading</a></li>
		</ul>
	</div>

	<!-- Section -->
	<section class="article-container">
		<div class="page-container">
		
			<div class="main-content">
				<article class="page-article" itemscope>
					
					<div class="page-directory-navigation">
						<div id="current-dir-nav"></div>
						<ul class="page-sub-directories">
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install">Install</a></li>
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install/wordpress">WordPress</a></li>
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install/single-sign-on">Single Sign-On</a></li>
							<li class="page-sub-directory selected-nav"><a href="https://docs.question2answer.org/pages/documentation/install/upgrading">Upgrading</a></li>
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install/optimization">Optimization</a></li>
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install/security">Security</a></li>
							<li class="page-sub-directory"><a href="https://docs.question2answer.org/pages/documentation/install/htaccess">.htaccess</a></li>
						</ul>
					</div>
					
					<div class="article-content-container">
						<h1 id="upgrading-to-the-latest-version-of-question2answer">Upgrading to the latest version of Question2Answer</h1>

						<p>Question2Answer regularly has <a href="https://github.com/q2a/question2answer/releases">new releases</a> that fix bugs and add new features. Updating your Q2A site is usually a simple process of uploading the new files and visiting your site to check for any database upgrades. Instructions in more detail:</p>

						<ol>
							<li>
								<p>Before upgrading, it is recommended to make a backup of your website, and of your MySQL database using <code class="language-plaintext highlighter-rouge">mysqldump</code> or a similar tool.</p>
							</li>
							<li>
								<p>If you have modified any core Q2A files, make a copy of your whole Q2A directory, to help reapply your changes after upgrading.</p>
							</li>
							<li>
								<p>Download the <a href="https://github.com/q2a/question2answer/releases">latest version of Question2Answer</a> to your computer or web server (also available <a href="https://github.com/q2a/question2answer">on GitHub</a>).</p>
							</li>
							<li>
								<p>Unzip the download using a tool such as <a href="http://www.winzip.com/">WinZip</a> (or <code class="language-plaintext highlighter-rouge">unzip</code> in the Unix shell).</p>
							</li>
							<li>
								<p>Turn on maintenance mode in your Q2A admin panel (General section). This will help prevent any errors showing to users while files are being uploaded.</p>
							</li>
							<li>Replace all the Question2Answer files and directories on your web server with the new ones, via (S)FTP or whatever deployment strategy you use.
								<ul>
									<li>Your custom <code class="language-plaintext highlighter-rouge">qa-config.php</code> and <code class="language-plaintext highlighter-rouge">.htaccess</code> files will not be affected, nor will your <code class="language-plaintext highlighter-rouge">qa-external</code> directory.</li>
									<li>You may need to reapply any other changes and reinstall any themes, languages or plugins as appropriate.</li>
								</ul>
							</li>
							<li>
								<p>Open your Question2Answer site in your browser, and go to the admin center. If appropriate, you will be prompted to upgrade the database, so follow the on-screen instructions.</p>
							</li>
							<li>Once the upgrade is complete, <strong>don’t forget to turn off mainenance mode</strong> so visitors can see the site again. You’ve now successfully upgraded - congratulations!</li>
						</ol>

						<h2 id="for-larger-sites-advanced">For larger sites (advanced)</h2>

						<p>Larger websites with a lot of traffic may wish to follow a slightly different process. Due to the way Q2A handles errors, visitors to your site may see the database upgrade screen after you’ve uploaded your files. To solve this problem we can temporarily serve a 503 Service Not Available error to the visitors, while allowing the site administrator to view the site and run the upgrade.</p>

						<p>The upgrade process then works as above, except that between steps 5 and 6 we turn on the 503 response as described below, then turn it off again after step 8.</p>

						<p>Here’s how to set it up on different servers. In the following examples, replace <code class="language-plaintext highlighter-rouge">/503.html</code> with your own error page if you have one (otherwise omit those lines for the default server page), and replace <code class="language-plaintext highlighter-rouge">127.0.0.1</code> with your IP address so you can access the site yourself. You can find your IP by <a href="https://www.google.com/search?q=what+is+my+ip">searching Google</a>.</p>

						<h3 id="apache">Apache</h3>

						<p>Add the following to your <code class="language-plaintext highlighter-rouge">.htaccess</code> file (or the appropriate <code class="language-plaintext highlighter-rouge">&lt;Directory&gt;</code> block within your Virtual Host server config).</p>

<pre class="highlight"><code>&lt;<span class="n">IfModule</span> <span class="n">mod_rewrite</span>.<span class="n">c</span>&gt;
<span class="n">ErrorDocument</span> <span class="m">503</span> /<span class="m">503</span>.<span class="n">html</span>
<span class="n">RewriteEngine</span> <span class="n">On</span>
<span class="n">RewriteCond</span> <span class="m">1</span> <span class="m">0</span>
<span class="n">RewriteCond</span> %{<span class="n">REMOTE_ADDR</span>} !^<span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>$
<span class="n">RewriteCond</span> %{<span class="n">REQUEST_URI</span>} !^/<span class="m">503</span>.<span class="n">html</span>$
<span class="n">RewriteRule</span> .* - [<span class="n">R</span>=<span class="m">503</span>]
&lt;/<span class="n">IfModule</span>&gt;
</code></pre>

						<p>Now the 503 response can be toggle by changing <code class="language-plaintext highlighter-rouge">RewriteCond 1 0</code> to <code class="language-plaintext highlighter-rouge">RewriteCond 1 1</code></p>

						<h3 id="nginx">Nginx</h3>

						<p>First add the following to the <code class="language-plaintext highlighter-rouge">http {}</code> section in <code class="language-plaintext highlighter-rouge">nginx.conf</code>.</p>

<pre><code>geo $maintenance {
    default         0;
    127.0.0.1       0;
}
</code></pre>

						<p>If you have your own 503 error page then add this line (with the appropriate URL) in the <code class="language-plaintext highlighter-rouge">server {}</code> block for your site:</p>

<pre class="highlight"><code><span class="k">error_page</span> <span class="mi">503</span> <span class="n">/503.html</span><span class="p">;</span>
</code></pre>

						<p>Next, in the site’s location block in <code class="language-plaintext highlighter-rouge">server {}</code> add this:</p>

<pre class="highlight"><code><span class="k">if</span> <span class="s">(</span><span class="nv">$maintenance</span><span class="s">)</span> <span class="p">{</span>
    <span class="kn">return</span> <span class="mi">503</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

						<p>For example a Q2A site at the root of the domain may look like this</p>

<pre><code>location / {
    if ($maintenance) {
        return 503;
    }
    try_files $uri /index.php?$request_uri;
}
</code></pre>

						<p>Now the 503 response can be toggled by changing the value of <code class="language-plaintext highlighter-rouge">default</code> from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">1</code> in <code class="language-plaintext highlighter-rouge">nginx.conf</code> and restarting Nginx. Of course, put it back to <code class="language-plaintext highlighter-rouge">0</code> to turn it off.</p>
						
					</div>
				</article>
			</div>
			
			<div class="sidebar">
				<ul class="docs-nav">
					<!-- Will Populate -->
				</ul>
			</div>
			
		</div>
	</section>
	
	<div class="jump-top-container">
		<div id="jump-top" class="jump-top"><span class="material-icons">arrow_upward</span></div>
	</div>
	
	<footer class="footer">
		<nav class="footer-nav">
			<ul class="footer-main-nav">
				<li>
					<a href="https://www.question2answer.org/" class="footer-site-logo">
						<img src="../../../images/branding/question2answer-logo-350x40.png">
					</a>
				</li>
				<li><a href="https://www.question2answer.org/feedback.php">Send feedback</a></li>
				<li><a href="https://www.question2answer.org/versions.php">Version history</a></li>
				<li><a href="https://www.question2answer.org/license.php">License details</a></li>
				<li><a href="http://demo.question2answer.org/">Demo sandbox</a></li>
			</ul>
			<div class="footer-credits-nav">
				Created by <a href="http://www.gidgreen.com">Gideon Greenspan</a> and <a href="https://github.com/q2a/question2answer/graphs/contributors">Contributors</a>.
			</div>
		</nav>
	</footer>

	<!-- Javascript main files -->
	<script src="../../../js/sticky_bar.js"></script>
	<script src="../../../js/main.js"></script>
	<script src="../../../js/highlight.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
  
	<!-- Scripts rom Q2A Docs - Classic version -->
	<script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>
	<script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-1165533-8&amp;l=dataLayer&amp;cx=c">
	</script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js">
	</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-1974891-11"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-1974891-11');
		gtag('config', 'UA-1165533-8'); // old tracking ID
	</script>

</body>

</html>